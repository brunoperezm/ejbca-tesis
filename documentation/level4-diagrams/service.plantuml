@startuml
!theme mars

class AuthenticateService {
    - certificate_repository: CertificateRepository
    - authorized_keys_builder: AuthorizedKeysBuilder
    - logger: Logger
    ====
    + __init__(certificate_repository, authorized_keys_builder, logger)
    + authenticate(serial_id: str, username: str): Tuple[AuthResponse, dict]
}

interface CertificateRepository {
    + is_revoked(serial_id: str): Tuple[bool, dict]
    + get_certificate(serial_id: str): Tuple[Certificate, dict]
}

class AuthorizedKeysBuilder {
    ====
    + __init__()
    + build(emailAddress: str, commonName: str, public_key: X509PublicKey): str
}

AuthenticateService --> CertificateRepository : depends on
AuthenticateService --> AuthorizedKeysBuilder : uses

note top of AuthenticateService
  **Capa de Aplicación**
  Orquesta el flujo de autenticación
end note

note right of CertificateRepository
  **Interfaz del Dominio**
  Abstracción para acceso a datos
end note

note bottom of AuthorizedKeysBuilder
  **Servicio de Dominio**
  Genera formato SSH
end note

@enduml